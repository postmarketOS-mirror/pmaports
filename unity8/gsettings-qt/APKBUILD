# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=gsettings-qt
pkgver=0_git20200715
_commit="e12a1df31013eb940b035602951af11cee16a758"
pkgrel=0
pkgdesc="Library to access GSettings from Qt"
url="https://github.com/ubports/gsettings-qt"
arch="all"
license="LGPL-3.0-only"
depends_dev="qt5-qtdeclarative-dev"
makedepends="$depends_dev qt5-qtbase-dev"
checkdepends="xvfb-run"
subpackages="$pkgname-dev"
source="$pkgname-$_commit.tar.gz::https://github.com/ubports/gsettings-qt/archive/$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"

build() {
	qmake-qt5
	make
}

check() {
	LD_LIBRARY_PATH=../src GSETTINGS_BACKEND=memory GSETTINGS_SCHEMA_DIR=. xvfb-run make check
}

package() {
	make INSTALL_ROOT="$pkgdir" install
}

sha512sums="6dd6d2290c29afd3404a82249c7429c6932b1e2eb33c37bad1440f04f6715a9dc7264fd0348c11d0dc8be4c78d7f1cc59f547cbcbf219f954e29cb5c58833d28  gsettings-qt-e12a1df31013eb940b035602951af11cee16a758.tar.gz"
