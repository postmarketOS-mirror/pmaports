# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=keyboard-component
pkgver=0_git20210520
_commit="1ec93c56ae53dd326d03cd8bf398467eb15e5a92"
pkgrel=0
pkgdesc="Ubuntu Touch keyboard as maliit plugin"
url="https://github.com/ubports/keyboard-component"
arch="all"
license="LGPL-3.0-only AND BSD-3-Clause"
makedepends="qt5-qtbase-dev maliit-framework-dev libpinyin-dev gsettings-qt-dev hunspell-dev presage-dev anthy-dev libchewing-dev"
checkdepends="xvfb-run bash"
subpackages="$pkgname-dev"
source="https://github.com/ubports/keyboard-component/archive/$_commit/keyboard-component-$_commit.tar.gz
	0001-Fix-api-changes.patch
	0002-Fix-a-switch-fall.patch
	0003-Link-properly-to-hunspell.patch
	0004-InputMethodHostProbe-mark-functions-as-override.patch
	0005-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
	0006-Prefix-MALIIT-variables-with-MALIIT_PREFIX.patch
	"
builddir="$srcdir/$pkgname-$_commit"

build() {
	qmake-qt5 PREFIX=/usr
	make
}

check() {
	xvfb-run -a make check
}

package() {
	make INSTALL_ROOT="$pkgdir" install
}

sha512sums="
d52bf5e85f9280521b781a1c46a39872636eb85ac49b82fe7bb8d43d1f72408ede508342c7a4b1bfbebf3cf70fbd9f21c88a3f5dc9e4f2a01908dd861d66548e  keyboard-component-1ec93c56ae53dd326d03cd8bf398467eb15e5a92.tar.gz
a1575b1a6b8a38152af138ab35faeacc6911c9053a719d13af0ad866fae257ce8d8a75c8274a78c31901c175b56d81b77ad8d58c60bed8bcafdc889681925993  0001-Fix-api-changes.patch
e7dcfa1eb62e5f592336f4ca77b0ed3f7afacc209c725e7932a20d47580ea04fdd99a34c687cc0feb026235c6cd615bd857640289507e72c5ad4853113dbe404  0002-Fix-a-switch-fall.patch
0eeb4018a2912249afff8ee6cbc22c6478381e4e3a49829cb619496e9b2077f1b87391ea8c11202fcccd4af4cee96f840b0cdefee1901164eb48bdc88ccb60a2  0003-Link-properly-to-hunspell.patch
cc6b2d32d65ebc9a106e3fab6ea3b208fd90e8306c1442fb1a73d4a56194a7da36ed708fddb909a6763db59bb89641dbd12c272a5e665d2b80f32302a851deb0  0004-InputMethodHostProbe-mark-functions-as-override.patch
0f4a051d1ff8a660e3fc5c2973d2cb24364879832e4aacea4f12873794d7aae7d2f3f5c6598cc06daa69d936ff4ce1af71b2bebb8ea699de65a7002386479f04  0005-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
4fac157dc59b567d3a1a3993a576868fb8294652c99a66be3a9e8d93a1f7bb9f373b4d74ce71fdcf4f5facf02744d150d7ba96f1317b3f0a7349c3f74100268a  0006-Prefix-MALIIT-variables-with-MALIIT_PREFIX.patch
"
